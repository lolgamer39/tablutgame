<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Tablut - The Viking Game</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <div class="container" id="view-home">
        <img src="title.png" alt="Tablut Logo" class="logo">
        
        <div class="buttons-grid">
            <button class="btn btn-primary" onclick="showView('view-mode')">Gioca Ora</button>
            <button class="btn btn-secondary" onclick="showView('view-tutorial')">Come si gioca</button>
            
            <div class="row" style="justify-content: center; margin-top: 5px;">
                <button class="btn btn-icon" onclick="toggleSettings()">‚öôÔ∏è</button>
            </div>
        </div>
    </div>

    <div class="container hidden" id="view-mode">
        <h2>Scegli Modalit√†</h2>
        <p>Sfida un amico sullo stesso schermo o online.</p>
        
        <div class="buttons-grid">
            <button class="btn btn-secondary" onclick="window.location.href='game/game.html?mode=local'">
                üè† Partita Locale
            </button>
            
            <button class="btn btn-primary" onclick="showView('view-online-setup')">
                üåç Partita Online
            </button>
            
            <button class="btn btn-outline" onclick="showView('view-home')">Indietro</button>
        </div>
    </div>

    <div class="container hidden" id="view-online-setup">
        <h2>Configura Partita</h2>
        
        <div class="input-group">
            <label class="input-label">Il tuo Nome</label>
            <input type="text" id="username" placeholder="Es. Ragnar Lothbrok" maxlength="12">
        </div>

        <div class="input-group">
            <label class="input-label">Tempo di Gioco</label>
            <select id="time-control">
                <option value="10">10 Minuti (Rapida)</option>
                <option value="30">30 Minuti (Classica)</option>
                <option value="no-time">Senza Tempo</option>
            </select>
        </div>

        <div class="buttons-grid" style="margin-top: 10px;">
            <button class="btn btn-primary" onclick="startOnlineGame()">Cerca Avversario</button>
            <button class="btn btn-outline" onclick="showView('view-mode')">Annulla</button>
        </div>
    </div>

    <div class="container hidden" id="view-tutorial" style="max-width: 500px;">
        <h2>Guida Tattica</h2>
        <div class="tutorial-scroll-area">
            
            <div class="tutorial-step">
                <h3>üôæ Le Due Fazioni</h3>
                <p>La scacchiera di tablut comprende 9x9 caselle. <br>
                I <strong>Bianchi </strong> hanno il Re al centro e 8 guardie. <br>
                I <strong>Neri </strong> sono in 12 e circondano la scacchiera.</p>
            </div>

            <div class="tutorial-step">
                <h3>üéØ L'Obiettivo</h3>
                <p><strong>Bianchi:</strong> Devono portare il Re in uno dei 4 <strong>angoli</strong> della scacchiera (rifugi) per scappare e vincere.</p>
                <p><strong>Neri:</strong> Devono <strong>catturare il Re</strong> circondandolo su 4 lati prima che scappi.</p>
            </div>

            <div class="tutorial-step">
                <h3>‚ôüÔ∏è Movimento</h3>
                <p>Tutti i pezzi si muovono di quante caselle vogliono in orizzontale o verticale (solo una direzione, non si possono mischiare), ma non possono saltare altri pezzi.</p>
                <p>Il re si muove invece di una sola casella adiacente a s√® in orizzontale o vertivale e non pu√≤ ovviamente saltare altri pezzi.</p>
                <p><em>Nota:</em> Il Re pu√≤ sostare sul trono centrale dall'inizio della partita fino a quando non vi esce con una mossa qualsiasi. Da quel momento non potr√† pi√π tornare sul trono. Tutti gli altri pezzi non possono sostare sul trono, ma possono saltarlo (re compreso).</p>
            </div>

            <div class="tutorial-step">
                <h3>ü™§ La Cattura</h3>
                <p>Non si mangia saltando sopra! Un pezzo nemico viene catturato se lo <strong>chiudi a sandwich</strong> tra due dei tuoi pezzi (custodia).</p>
                <p><em>Esempio:</em> ‚ö™ ‚ö´ ‚ö™ -> Il nero viene eliminato.</p>
            </div>

            <div class="tutorial-step">
                <h3>üëë Il Re</h3>
                <p>Fuori dal trono, il re partecipa alle catture come un soldato normale.</p>
                <p>Per catturare il Re servono <strong>4 attaccanti</strong> che lo circondino sopra, sotto a destra e a sinistra. Il quel caso il re risulta catturato e il nero vince la partita. Se il re si trova in una delle caselle del bordo, bastano 3 soldati al nero per catturarlo. Se il re si trova in una delle caselle adiacenti al trono, allora lo si pu√≤ catturare con 3 pedine che lo circondano (dato che nessuna pedina pu√≤ stare sul trono) e una dall'altra parte del trono.</p>
                <p></p>
            </div>

            <div class="tutorial-step">
                <h3>‚úñÔ∏è Stallo</h3>
                <p>Se la posizione non consente pi√π mosse disponibili viene dichiarata la patta.</p>
                <p>Se la posizione viene ripetuta per 3 volte in modo identico viene dichiarata la patta.</p>
                <p></p>
            </div>

        </div>
        <button class="btn btn-outline" onclick="showView('view-home')">Torna al Menu</button>
    </div>

    <div id="settings-modal" class="settings-overlay hidden">
        <div class="settings-box">
            <h2>Impostazioni</h2>
            <br>
            <div class="input-group">
                <label class="input-label">Musica</label>
                <select>
                    <option>Attiva</option>
                    <option>Disattivata</option>
                </select>
            </div>
            <br>
            <button class="btn btn-outline" onclick="toggleSettings()">Chiudi</button>
        </div>
    </div>

    <script>
        // Gestione Navigazione tra le "Viste"
        function showView(viewId) {
            // Nascondi tutte le schermate
            document.querySelectorAll('.container').forEach(el => {
                el.classList.add('hidden');
                el.classList.remove('fade-in');
            });
            
            // Mostra quella richiesta con animazione
            const target = document.getElementById(viewId);
            if(target) {
                target.classList.remove('hidden');
                void target.offsetWidth; // Trigger reflow per riavviare animazione
                target.classList.add('fade-in');
            }
        }

        // Gestione Settings
        function toggleSettings() {
            document.getElementById('settings-modal').classList.toggle('hidden');
        }

        // Avvio Partita Online
        function startOnlineGame() {
            const name = document.getElementById('username').value.trim();
            const time = document.getElementById('time-control').value;
            
            if (!name) {
                alert("Per favore, inserisci un nome per giocare online!");
                return;
            }
            
            // Reindirizza alla pagina di gioco con i parametri corretti
            window.location.href = `game/game.html?mode=online&name=${encodeURIComponent(name)}&time=${time}`;
        }
    </script>

</body>
</html>
